## php5升级到php7 后，mysql数据库关联出现问题

### 1、升级版本

今天在 wordpress 博客后台更新文章时，提醒可升级到最新的PHP版本 (7.3) ，将会有更快的网站访问速度以及对搜索引擎更加友好。

于是乎就登录了阿里云的控制台，升级 PHP 版本到最新的版本7.2版本 (如图1)。

![](http://www.jerrychane.com/wp-content/uploads/2019092801.png)

以为只要升级一下就好了。结果打开网站，整个网站报 “ **建立数据库连接时出错**” (如图2)。

![](http://www.jerrychane.com/wp-content/uploads/2019092802.png)

### 2、错误分析

发现原来 mysql 数据库连接，原来16位的数据库加密模式，在PHP7版本下已不支持了，导致连接数据库时密码错误，自然整个数据库无法连接而报错。实际上，PHP5.3、5.4、5.5、7.2版本,加密模式设置为41位。

### 3、解决方案

第1步：在阿里云控制台 - 主机管理控制台 - 数据库信息 - 重置密码 ，选择设置新密码，并将加密模式由默认的16位，变为41位；

第2步：修改 wordpress 网站 wp-config.php中数据库的密码，为刚刚新设置的密码。

最后重新打开网站，发现一切都恢复如初，网站访问速度的确是快了很多。